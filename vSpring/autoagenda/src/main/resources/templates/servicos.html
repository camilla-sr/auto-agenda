<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Serviços - Centro Automotivo JJ</title>
  <link rel="stylesheet" href="/fontawesome/css/all.min.css">
  <link rel="stylesheet" href="/css/style1.css">
  <script src="/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="/js/sweetalert2.all.min.js"></script>
  <script src="/js/validacao.js"></script>
</head>
<body>

	<div th:replace="~{barra :: barra}"></div>

  <main class="main-content">
    <div class="container">

      <div class="page-header">
        <h2><i class="fas fa-tools"></i> Gerenciamento de Serviços</h2>
        <p>Controle e cadastre novos serviços</p>
      </div>

      <div class="form-container">
        <div class="form-header">
          <h3><i class="fas fa-plus-circle"></i> Cadastrar Novo Serviço</h3>
        </div>

        <form method="post"action="/servico-api/salvar" id="form-servico" >
			<input type="hidden" name="idServico" id="idServico" readonly>
          <div class="form-row">
            <div class="form-col">
              <div class="form-group">
                <label for="nome-servico">Nome do Serviço</label>
                <input type="text" id="nome-servico" name="nomeServico" class="form-input" placeholder="Ex: Troca de óleo" >
              </div>
            </div>
            <div class="form-col">
              <div class="form-group">
                <label for="descricao-servico">Descrição</label>
                <input type="text" id="descricao-servico" name="descServico" class="form-input" placeholder="Ex: Troca de óleo do motor" >
              </div>
            </div>
          </div>

          <div class="form-actions">
            <button type="reset" class="btn btn-secondary">
              <i class="fas fa-times"></i> Cancelar
            </button>
            <button type="submit" class="btn">
              <i class="fas fa-save"></i> Salvar Serviço
            </button>
          </div>
        </form>
		<form id="deleteForm" action="servico-api/apagar" method="post" style="display: none;">
		    <input type="hidden" name="idServico" id="deleteId">
		</form>
      </div>

      <!-- Filtros de Busca -->
      <div class="form-container">
        <div class="form-header">
          <h3><i class="fas fa-search"></i> Buscar Serviço</h3>
        </div>
        <div class="form-group">
          <input type="text" id="busca-servico" class="form-input" placeholder="Digite para buscar...">
        </div>
      </div>

      <div class="table-container">
        <div class="table-header">
          <h3><i class="fas fa-clipboard-list"></i> Lista de Serviços</h3>
        </div>

        <table class="table">
          <thead>
            <tr>
              <th>Serviço</th>
              <th>Descrição</th>
              <th>Ações</th>
            </tr>
          </thead>
          <tbody>
			<tr th:if="${servicos == null or servicos.empty}">
				<td colspan="3">Nenhum resultado encontrado</td>
			</tr>
            <tr th:each="serv : ${servicos}">
              <td class="nome-servico" th:text="${serv.nomeServico}"></td>
              <td class="desc-servico" th:text="${serv.descServico}"></td>
			  
              <td class="action-buttons">
                <button class="btn btn-action edit-btn" th:attr="data-id=${serv.idServico}" title="Editar">
                  <i class="fas fa-edit"></i>
                </button>
                <button class="btn btn-action delete-btn" th:attr="data-id=${serv.idServico}" title="Excluir">
                  <i class="fas fa-trash"></i>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

    </div>
  </main>

  <!-- Rodapé -->
  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-logo">
          <i class="fas fa-car-alt"></i>
          <span class="logo-highlight">Centro Automotivo</span> JJ
        </div>
        <p>&copy; 2025 Centro Automotivo JJ. Todos os direitos reservados 2025.</p>
      </div>
    </div>
  </footer>
  <script>
	  document.addEventListener('DOMContentLoaded', function() {
	      const editButtons = document.querySelectorAll('.edit-btn');
	
	      editButtons.forEach(function(button) {
	        button.addEventListener('click', function() {
	          const row = button.closest('tr');
	
	          const id = button.dataset.id;
	          const nome = row.querySelector('.nome-servico').textContent.trim();
	          const descricao = row.querySelector('.desc-servico').textContent.trim();
	
	          document.getElementById('idServico').value = id;
	          document.getElementById('nome-servico').value = nome;
	          document.getElementById('descricao-servico').value = descricao;
	
	        });
	      });
	  	
	  	const deleteButtons = document.querySelectorAll('.delete-btn');
	
	  	    deleteButtons.forEach(function(button) {
	  	      button.addEventListener('click', function(e) {
	  	        e.preventDefault();
	
	  	        const id = button.dataset.id;
	
	  	        Swal.fire({
	  	          title: 'Você tem certeza?',
	  	          text: "Esta ação não poderá ser desfeita!",
	  	          icon: 'warning',
	  	          showCancelButton: true,
	  	          confirmButtonColor: '#d33',
	  	          cancelButtonColor: '#3085d6',
	  	          confirmButtonText: 'Sim, excluir!',
	  	          cancelButtonText: 'Cancelar'
	  	        }).then((result) => {
	  	          if (result.isConfirmed) {
	  	            document.getElementById('deleteId').value = id;
	  	            document.getElementById('deleteForm').submit();
	  	          }
	  	        });
	  	      });
	  	    });
	    });
  </script>
</body>
</html>
